function onPopState(t){if(window.history&&window.history.pushState)return $(window).bind("popstate",function(){initialPop=!popped&&location.href===initialURL,popped=!0,initialPop||t()})}popped="state"in window.history,initialURL=location.href,$(document).ready(function(){BrowserFallbacks.init(),Search.init(),Dropdowns.init(),Forms.init(),Downloads.init(),DownloadBox.init(),AboutContent.init()});var DownloadBox={init:function(){$("#gui-os-filter").addClass("visible");var t=window.session.browser.os;"Mac"==t?($(".monitor").addClass("mac"),$("#download-link").text("Download "+$("#installer-version").attr("data-mac")+" for Mac").attr("href","/download/mac"),$("#gui-link").removeClass("mac").addClass("gui"),$("#gui-link").text("Mac GUIs").attr("href","/download/gui/mac"),$("#gui-os-filter").attr("data-os","mac"),$("#gui-os-filter").text("Only show GUIs for my OS (Mac)")):"Windows"==t?($(".monitor").addClass("windows"),$("#download-link").text("Download "+$("#installer-version").attr("data-win")+" for Windows").attr("href","/download/win"),$("#gui-link").removeClass("mac").addClass("gui"),$("#gui-link").text("Windows GUIs").attr("href","/download/gui/win"),$("#alt-link").removeClass("windows").addClass("mac"),$("#alt-link").text("Mac Build").attr("href","/download/mac"),$("#gui-os-filter").attr("data-os","windows"),$("#gui-os-filter").text("Only show GUIs for my OS (Windows)")):"Linux"==t&&($(".monitor").addClass("linux"),$("#download-link").text("Downloads for Linux").attr("href","/download/linux"),$("#gui-link").removeClass("mac").addClass("gui"),$("#gui-link").text("Linux GUIs").attr("href","/download/gui/linux"),$("#alt-link").removeClass("windows").addClass("mac"),$("#alt-link").text("Mac Build").attr("href","/download/mac"),$("#gui-os-filter").attr("data-os","linux"),$("#gui-os-filter").text("Only show GUIs for my OS (Linux)"))}},BrowserFallbacks={init:function(){BrowserFallbacks.initPlaceholders()},initPlaceholders:function(){Modernizr.input.placeholder||$("input[placeholder], textarea[placeholder]").each(function(){$(this).defaultValue($(this).attr("placeholder"),"active","inactive")})}},Search={searching:!1,currentSearch:"",selectedIndex:0,init:function(){Search.observeFocus(),Search.observeTextEntry(),Search.observeResultsClicks()},observeFocus:function(){$("form#search input").focus(function(){$(this).parent("form#search").switchClass("","focus",200)}),$("form#search input").blur(function(){Search.resetForm()})},observeTextEntry:function(){$("form#search input").keyup(function(){Search.runSearch()}),$("form#search input").keydown(function(t){switch($("#search-results").not(":visible")&&27!=t.which&&($("#search-results").fadeIn(.2),Search.highlight(Search.selectedIndex)),t.which){case 13:return Search.selectResultOption(),!1;case 27:Search.resetForm();break;case 38:t.preventDefault(),Search.resultsNav("up");break;case 40:t.preventDefault(),Search.resultsNav("down")}})},observeResultsClicks:function(){$("#search-results").mousedown(function(t){t.preventDefault()})},runSearch:function(){var t=$("#search-text").val();if(t.length<2)return!1;Search.searching?(clearTimeout(Search.timeout),Search.timeout=setTimeout(function(){Search.searching=!1,Search.runSearch()},300)):(Search.searching=!0,t!=Search.currentSearch&&(Search.currentSearch=t,$.get("/search",{search:t},function(t){$("#search-results").html(t),Search.searching=!1},"html")))},selectResultOption:function(){var t=$("#search-results a")[Search.selectedIndex],e=$(t).attr("href");if(!t){e="/search/results?search="+$("#search-text").val()}window.location.href=e,selectedIndex=0},resultsNav:function(t){Search.selectedIndex+="down"==t?1:-1,Search.highlight(Search.selectedIndex)},highlight:function(t){var e=$("#search-results a").removeClass("highlight");$(e[t]).addClass("highlight")},resetForm:function(){$("form#search").switchClass("focus","",200),$("#search-results").fadeOut(.2),Search.selectedIndex=0}},Dropdowns={init:function(){Dropdowns.observeTriggers()},observeTriggers:function(){$(".dropdown-trigger").click(function(t){t.preventDefault();var e=$(this).attr("data-panel-id");$(this).hasClass("active")?($(this).removeClass("active"),$("#"+e).hide()):($(this).addClass("active"),$("#"+e).show())})}},Forms={init:function(){Forms.observeCopyableInputs()},observeCopyableInputs:function(){$("input.copyable").click(function(){$(this).select()})}},Downloads={init:function(){Downloads.observeGUIOSFilter(),Downloads.observePopState(),Downloads.filterGUIS()},getOSFilter:function(){var t=location.href.substring(location.href.lastIndexOf("/")+1);return"linux"===t||"mac"===t||"windows"===t||"android"===t||"ios"===t?t:""},capitalizeOS:function(t){return{linux:"Linux",mac:"Mac",windows:"Windows",android:"Android",ios:"iOS"}[t]},filterGUIS:function(){var t=Downloads.getOSFilter(),e=Downloads.capitalizeOS(t);if($("a.gui-os-filter").not("[data-os='"+t+"']").removeClass("selected"),$("a.gui-os-filter").filter("[data-os='"+t+"']").addClass("selected"),""===t)$("ul.gui-thumbnails li").removeClass("masked"),$("#os-filter-count").hide();else{$("ul.gui-thumbnails li").filter("."+t).removeClass("masked"),$("ul.gui-thumbnails li").not("."+t).addClass("masked");var o=$("ul.gui-thumbnails li."+t).length;$("#os-filter-count strong").html(o),$("#os-filter-count .os").html(e),$("#os-filter-count").show()}},observeGUIOSFilter:function(){$("a.gui-os-filter").click(function(t){t.preventDefault();var e=$(this).attr("data-os");if(window.history&&window.history.pushState){var o=""===e?"/downloads/guis/":"/download/gui/"+e;history.pushState(null,$(this).html(),o)}Downloads.filterGUIS()})},observePopState:function(){onPopState(function(){Downloads.filterGUIS()})}},AboutContent={defaultSection:"branching-and-merging",init:function(){0!==$("body#about").length&&($("section.about").hide(),$("section.about .bottom-nav").show(),AboutContent.observeNav(),AboutContent.observePopState(),AboutContent.showSection(AboutContent.getSection()))},observePopState:function(){onPopState(function(){return section=AboutContent.getSection(),AboutContent.showSection(section)})},getSection:function(){var t;return t=location.href.substring(location.href.lastIndexOf("/")+1),0!==t.length&&"about"!=t||(t=AboutContent.defaultSection),t},showSection:function(t){"about"==t&&(t=AboutContent.defaultSection),$("ol#about-nav a").removeClass("current"),$("ol#about-nav a#nav-"+t).addClass("current"),$("section").hide(0,function(){$("section#"+t).show()})},observeNav:function(){$("ol#about-nav a, .bottom-nav a").click(function(t){t.preventDefault();var e=$(this).attr("data-section-id");window.history&&window.history.pushState&&history.pushState(null,$(this).html(),"/about/"+e),AboutContent.showSection(e)})}};